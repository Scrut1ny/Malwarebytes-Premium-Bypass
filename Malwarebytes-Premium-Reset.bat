:: ==================================================
::  Malwarebytes-Premium-Reset v12.4
:: ==================================================
::  Dev  - Scut1ny
::  Help - 
::  Link - https://github.com/Scrut1ny/Malwarebytes-Premium-Reset
:: ==================================================


@echo off
title Malwarebytes-Premium-Reset ^| v12.4

:: Check for administrator privileges
fltmc >nul 2>&1 || (
    echo( && echo   [33m# Administrator privileges are required. && echo([0m
    PowerShell Start -Verb RunAs '%0' 2> nul || (
        echo   [33m# Right-click on the script and select "Run as administrator".[0m
        >nul pause && exit 1
    )
    exit 0
)

cls && echo( && echo   [94mMalwarebytes[0m: [33mPremium[0m - [[31mBYPASS[0m]
echo   --------------------------------

"%SystemRoot%\System32\schtasks.exe" /query /tn "Malwarebytes-Premium-Reset" >nul 2>&1
::checks to see if the task already exists and askes to run the task instead
if %errorlevel% equ 0 (
    echo( && echo   [[93m![0m] Scheduled task already exists
echo   ---------------------------------

    choice /C yn /M "Would you like to manually run the task? "
    if errorlevel 2 (

     cls && echo  Thank you for using the software it will run the reset task in 13 days & timeout /t 6 >nul & exit
    ) else (
        echo   Running the task manually...
cls

	echo Please Wait........  && timeout /t 5 >nul
 cls
        echo Killing Any certain Mbam Processes!!!!!
        taskkill /F /IM mbam.exe >nul 2>&1
        taskkill /F /IM mbamtray.exe >nul 2>&1
        echo mbam.exe,mbamtray.exe have been Killed. && timeout /t 5 >nul
cls
	schtasks /run /tn "Malwarebytes-Premium-Reset"

 
echo Please Wait!!!! && timeout /t 3 >nul
start "" "%ProgramFiles%\Malwarebytes\Anti-Malware\mbamtray.exe"
start "" "%ProgramFiles%\Malwarebytes\Anti-Malware\mbam.exe"
cls
echo Finished running the task which Spoofed the cryptography MachineGuid
echo off
echo please quit Mbam from the tray and restart Mbam for changes to take effect
echo off
echo  you'll know it worked as the version will change to 3.0.0 at the top then ask to activate the trial next check for an update then close and reopen

pause

     
    )
) else (
    for /f %%a in ('powershell -c "[guid]::NewGuid().ToString()"') do (reg add "HKLM\SOFTWARE\Microsoft\Cryptography" /v "MachineGuid" /t REG_SZ /d "%%a" /f) >nul
    >nul schtasks /create /tn "Malwarebytes-Premium-Reset" /tr "\"%comspec%\" /c \"for /f \"usebackq\" %A in (`powershell -c \"[guid]::NewGuid(^).ToString(^)\"`) do (reg add \"HKLM\SOFTWARE\Microsoft\Cryptography\" /v \"MachineGuid\" /t REG_SZ /d \"%A\" /f)\"" /sc daily /mo 13 /rl highest
    "%ProgramFiles%\Malwarebytes\Anti-Malware\mbam.exe" >nul 2>&1
    echo( && echo   [[92m+[0m] Spoofed cryptography MachineGuid
    echo( && echo   [[92m+[0m] Created scheduled task


)
