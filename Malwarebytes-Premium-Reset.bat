:: ==================================================
::  Malwarebytes-Premium-Reset v12.3
:: ==================================================
::  Dev  - Scut1ny
::  Help - 
::  Link - https://github.com/Scrut1ny/Malwarebytes-Premium-Reset
:: ==================================================


@echo off
title Malwarebytes-Premium-Reset ^| v12.3


:: ==================================================
:: Check for administrator privileges
:: ==================================================

fltmc >nul 2>&1 || (
    echo( && echo   [33m# Administrator privileges are required. && echo([0m
    PowerShell Start -Verb RunAs '%0' 2> nul || (
        echo   [33m# Right-click on the script and select "Run as administrator".[0m
        >nul pause && exit 1
    )
    exit 0
)

:: ==================================================


:: ==================================================
:: Script
:: ==================================================

cls && echo( && echo   [94mMalwarebytes[0m: [33mPremium[0m - [[31mBYPASS[0m]
echo   --------------------------------

"%SystemRoot%\System32\schtasks.exe" /query /tn "Malwarebytes-Premium-Reset" >nul 2>&1

if %errorlevel% equ 0 (
	echo( && echo   [[93m![0m] Scheduled task already exists
	for /f %%a in ('powershell -c "[guid]::NewGuid().ToString()"') do (reg add "HKLM\SOFTWARE\Microsoft\Cryptography" /v "MachineGuid" /t REG_SZ /d "%%a" /f) >nul
	"%ProgramFiles%\Malwarebytes\Anti-Malware\mbam.exe" >nul 2>&1
	echo( && echo   [[92m+[0m] Spoofed cryptography MachineGuid
) else (
	for /f %%a in ('powershell -c "[guid]::NewGuid().ToString()"') do (reg add "HKLM\SOFTWARE\Microsoft\Cryptography" /v "MachineGuid" /t REG_SZ /d "%%a" /f) >nul
	@REM >nul schtasks /create /tn "Malwarebytes-Premium-Reset" /tr "\"%comspec%\" /c \"for /f \"usebackq\" %A in (`powershell -c \"[guid]::NewGuid(^).ToString(^)\"`) do (reg add \"HKLM\SOFTWARE\Microsoft\Cryptography\" /v \"MachineGuid\" /t REG_SZ /d \"%A\" /f)\"" /sc daily /mo 13 /rl highest
	>nul schtasks /create /tn "Malwarebytes-Premium-Reset" /tr "\"%comspec%\" /c \"for /f \"usebackq\" %A in (`powershell -c \"[guid]::NewGuid(^).ToString(^)\"`) do (reg add \"HKLM\SOFTWARE\Microsoft\Cryptography\" /v \"MachineGuid\" /t REG_SZ /d \"%A\" /f)\"" /sc daily /mo 13 /rl highest /st 00:00 /sc onstart

	"%ProgramFiles%\Malwarebytes\Anti-Malware\mbam.exe" >nul 2>&1
	echo( && echo   [[92m+[0m] Spoofed cryptography MachineGuid
	echo( && echo   [[92m+[0m] Created scheduled task
)

echo( && echo   [[92m+[0m] Done && timeout /t 4 >nul && del /F /Q %0 & exit

:: ==================================================
